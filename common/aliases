# vi: set ft=sh:

function if_os() {
    [[ "$OSTYPE" == *"$1"* ]];
}

function is_linux() {
    if_os linux
}

function is_darwin() {
    if_os darwin
}

function is_windows() {
    case "$OSTYPE" in
        *cygwin* | *msys* | *win32* ) sys="windows";;
    esac
    [[ "${sys}" == "windows" ]];
}

function screen() {
    echo "Ditch screen and use tmux. If you still want to use screen, then try 'command screen'.";
}

function tmux() {
    tmux_version=`command tmux -V | awk -F " " '{print $2}'`
    if [[ "${tmux_version}" == "2.2" ]]; then
        # need this for tmux version 2.2 only.
        if is_darwin; then
            export EVENT_NOKQUEUE=1
            export EVENT_NOPOLL=1
        elif is_linux; then
            export EVENT_NOEPOLL=1
        fi
    fi
    command tmux -2 $@
}

function binary_exists() {
    which ${1} &> /dev/null
}

if binary_exists nvim ; then
    function vim() {
        nvim $@
    }
fi

if binary_exists vim ; then
    function vi() {
        vim $@
    }
fi

function vimdiff() {
    vi -d $@
}

function svn_diff() {
    svn diff --internal-diff "$@" | vi -R -
}

function git_diff() {
    git diff --no-ext-diff -w "$@" | vi -R -
}

function upgrade_vim_plugins() {
    vi +PlugUpdate +qa
}

if is_darwin; then
    function upgrade_brew_packages() {
        echo "====>>>> Updating homebrew"
        brew update
        echo "====>>>> Upgrading outdated brew packages"
        brew upgrade && brew cleanup
        echo "====>>>> Upgrading outdated cask packages"
        brew cu && brew cask cleanup
    }
fi
